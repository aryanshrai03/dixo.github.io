<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>diXo - AI Diary Writer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #00d9ff;
            --secondary: #7000ff;
            --accent: #ff006e;
            --dark-bg: #0a0a0f;
            --card-bg: rgba(20, 20, 30, 0.85);
            --text-primary: #ffffff;
            --text-secondary: #b0b0c8;
            --border-glow: rgba(0, 217, 255, 0.3);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(2deg); }
            66% { transform: translateY(-10px) rotate(-2deg); }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        @keyframes shimmer {
            0% { background-position: -1000px 0; }
            100% { background-position: 1000px 0; }
        }

        @keyframes borderGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 217, 255, 0.3), inset 0 0 20px rgba(0, 217, 255, 0.1); }
            50% { box-shadow: 0 0 40px rgba(0, 217, 255, 0.6), inset 0 0 30px rgba(0, 217, 255, 0.2); }
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a2e 25%, #16213e 50%, #0f3460 75%, #0a0a0f 100%);
            background-size: 400% 400%;
            animation: gradientShift 15s ease infinite;
            min-height: 100vh;
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 217, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 0, 110, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(112, 0, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 1;
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 2;
        }

        .logo-container {
            text-align: center;
            margin: 60px 0 80px;
            animation: float 6s ease-in-out infinite;
        }

        .logo-wrapper {
            display: inline-block;
            position: relative;
            padding: 10px;
        }

        .logo-wrapper::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, var(--primary), var(--secondary), var(--accent), var(--primary));
            background-size: 300% 300%;
            border-radius: 30px;
            animation: gradientShift 3s ease infinite;
            filter: blur(15px);
            opacity: 0.6;
            z-index: -1;
        }

        .logo {
            width: 220px;
            height: 220px;
            border-radius: 25px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 3px solid rgba(0, 217, 255, 0.5);
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
        }

        .logo:hover {
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 25px 80px rgba(0, 217, 255, 0.4);
        }

        .brand-title {
            margin-top: 30px;
            font-size: 56px;
            font-weight: 900;
            background: linear-gradient(90deg, var(--primary), var(--secondary), var(--accent));
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s linear infinite;
            letter-spacing: 2px;
            text-shadow: 0 0 30px rgba(0, 217, 255, 0.5);
        }

        .brand-subtitle {
            color: var(--text-secondary);
            font-size: 18px;
            margin-top: 10px;
            letter-spacing: 4px;
            text-transform: uppercase;
        }

        .home-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 40px;
            margin-top: 80px;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
        }

        .option-card {
            background: var(--card-bg);
            border: 2px solid transparent;
            border-radius: 25px;
            padding: 50px 40px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            backdrop-filter: blur(20px);
            box-shadow: 0 15px 50px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .option-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 217, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .option-card:hover::before {
            left: 100%;
        }

        .option-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 25px;
            padding: 2px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .option-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 70px rgba(0, 217, 255, 0.4);
        }

        .option-card:hover::after {
            opacity: 1;
        }

        .option-icon {
            font-size: 56px;
            margin-bottom: 20px;
            display: block;
            animation: pulse 2s ease-in-out infinite;
        }

        .option-card h2 {
            font-size: 28px;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }

        .option-card p {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 1.6;
        }

        .editor-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .editor-title {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .back-btn {
            background: linear-gradient(135deg, var(--accent), #ff4081);
            border: none;
            padding: 14px 32px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 8px 25px rgba(255, 0, 110, 0.3);
        }

        .back-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 0, 110, 0.5);
        }

        .back-btn:active {
            transform: translateY(-1px);
        }

        .toolbar {
            background: var(--card-bg);
            border: 2px solid var(--border-glow);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            backdrop-filter: blur(20px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            animation: borderGlow 3s ease-in-out infinite;
        }

        .toolbar button,
        .toolbar select {
            background: rgba(0, 217, 255, 0.1);
            border: 1.5px solid rgba(0, 217, 255, 0.3);
            padding: 10px 20px;
            border-radius: 12px;
            color: var(--primary);
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .toolbar button:hover,
        .toolbar select:hover {
            background: rgba(0, 217, 255, 0.25);
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(0, 217, 255, 0.3);
            transform: translateY(-2px);
        }

        .toolbar button:active {
            transform: translateY(0);
        }

        .toolbar input[type="color"] {
            width: 50px;
            height: 42px;
            border: 1.5px solid rgba(0, 217, 255, 0.3);
            border-radius: 12px;
            cursor: pointer;
            background: transparent;
            transition: all 0.3s ease;
        }

        .toolbar input[type="color"]:hover {
            border-color: var(--primary);
            box-shadow: 0 5px 20px rgba(0, 217, 255, 0.3);
        }

        .ai-btn {
            background: linear-gradient(135deg, var(--secondary), var(--primary)) !important;
            color: white !important;
            border: none !important;
            padding: 12px 24px !important;
            font-weight: 700 !important;
            box-shadow: 0 8px 25px rgba(112, 0, 255, 0.4) !important;
        }

        .ai-btn:hover {
            box-shadow: 0 12px 35px rgba(112, 0, 255, 0.6) !important;
        }

        .diary-editor {
            background: rgba(255, 255, 255, 0.97);
            border: 2px solid var(--border-glow);
            border-radius: 20px;
            padding: 40px;
            min-height: 600px;
            color: #1a1a2e;
            font-size: 17px;
            line-height: 2;
            outline: none;
            box-shadow: 0 15px 60px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
            font-family: 'Georgia', serif;
        }

        .diary-editor:focus {
            border-color: var(--primary);
            box-shadow: 0 15px 60px rgba(0, 217, 255, 0.3);
        }

        .export-section {
            margin-top: 40px;
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .export-section input {
            background: var(--card-bg);
            border: 2px solid var(--border-glow);
            padding: 16px 24px;
            border-radius: 15px;
            color: white;
            font-size: 17px;
            flex: 1;
            min-width: 250px;
            transition: all 0.3s ease;
            backdrop-filter: blur(20px);
        }

        .export-section input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 5px 25px rgba(0, 217, 255, 0.3);
        }

        .export-section input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .export-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border: none;
            padding: 16px 40px;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            font-size: 17px;
            font-weight: 700;
            transition: all 0.3s ease;
            box-shadow: 0 10px 35px rgba(0, 217, 255, 0.4);
            white-space: nowrap;
        }

        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 45px rgba(0, 217, 255, 0.6);
        }

        .export-btn:active {
            transform: translateY(-1px);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid var(--border-glow);
            border-radius: 25px;
            padding: 50px;
            max-width: 600px;
            width: 90%;
            box-shadow: 0 25px 100px rgba(0, 217, 255, 0.4);
            animation: slideUp 0.4s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-content h2 {
            margin-bottom: 25px;
            font-size: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }

        .modal-content textarea {
            width: 100%;
            background: rgba(26, 26, 62, 0.6);
            border: 2px solid var(--border-glow);
            padding: 20px;
            border-radius: 15px;
            color: white;
            font-size: 16px;
            min-height: 150px;
            resize: vertical;
            font-family: inherit;
            line-height: 1.6;
            transition: all 0.3s ease;
        }

        .modal-content textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 5px 25px rgba(0, 217, 255, 0.3);
        }

        .modal-content textarea::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }

        .modal-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 17px;
            font-weight: 700;
            transition: all 0.3s ease;
        }

        .generate-btn {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 8px 30px rgba(0, 217, 255, 0.4);
        }

        .generate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(0, 217, 255, 0.6);
        }

        .cancel-btn {
            background: linear-gradient(135deg, var(--accent), #ff4081);
            color: white;
            box-shadow: 0 8px 30px rgba(255, 0, 110, 0.4);
        }

        .cancel-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 40px rgba(255, 0, 110, 0.6);
        }

        .loading {
            display: none;
            text-align: center;
            margin-top: 20px;
            color: var(--primary);
            font-size: 16px;
            font-weight: 600;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        input[type="file"] {
            display: none;
        }

        footer {
            background: linear-gradient(180deg, transparent, rgba(10, 10, 15, 0.95));
            border-top: 2px solid var(--border-glow);
            padding: 50px 20px;
            text-align: center;
            margin-top: 100px;
            backdrop-filter: blur(20px);
            position: relative;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        .footer-text {
            color: var(--text-secondary);
            font-size: 16px;
            line-height: 2;
            margin: 15px 0;
        }

        .footer-text strong {
            color: var(--primary);
            font-weight: 700;
        }

        .footer-divider {
            color: var(--border-glow);
            margin: 25px 0;
            font-size: 12px;
            letter-spacing: 2px;
        }

        .footer-copyright {
            color: #666;
            font-size: 14px;
            margin-top: 20px;
        }

        .social-links {
            margin-top: 25px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }

        .social-link {
            color: var(--primary);
            font-size: 24px;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            transform: translateY(-5px);
            filter: drop-shadow(0 5px 15px rgba(0, 217, 255, 0.6));
        }

        @media (max-width: 1200px) {
            .container {
                padding: 30px 20px;
            }

            .brand-title {
                font-size: 48px;
            }

            .home-options {
                gap: 30px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }

            .logo-container {
                margin: 40px 0 60px;
            }

            .logo {
                width: 160px;
                height: 160px;
            }

            .brand-title {
                font-size: 40px;
            }

            .brand-subtitle {
                font-size: 14px;
                letter-spacing: 2px;
            }

            .home-options {
                grid-template-columns: 1fr;
                gap: 20px;
                margin-top: 60px;
            }

            .option-card {
                padding: 35px 30px;
            }

            .option-icon {
                font-size: 48px;
            }

            .option-card h2 {
                font-size: 24px;
            }

            .option-card p {
                font-size: 15px;
            }

            .editor-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .editor-title {
                font-size: 28px;
            }

            .back-btn {
                width: 100%;
                padding: 12px 24px;
            }

            .toolbar {
                padding: 15px;
                gap: 10px;
            }

            .toolbar button,
            .toolbar select {
                padding: 8px 16px;
                font-size: 14px;
            }

            .toolbar input[type="color"] {
                width: 42px;
                height: 38px;
            }

            .diary-editor {
                padding: 25px;
                min-height: 450px;
                font-size: 16px;
            }

            .export-section {
                flex-direction: column;
            }

            .export-section input,
            .export-btn {
                width: 100%;
                min-width: unset;
            }

            .modal-content {
                padding: 35px;
                width: 95%;
            }

            .modal-content h2 {
                font-size: 26px;
            }

            .modal-content textarea {
                min-height: 120px;
                font-size: 15px;
            }

            footer {
                padding: 35px 20px;
                margin-top: 80px;
            }

            .footer-text {
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px 10px;
            }

            .logo-container {
                margin: 30px 0 50px;
            }

            .logo {
                width: 130px;
                height: 130px;
            }

            .brand-title {
                font-size: 32px;
            }

            .brand-subtitle {
                font-size: 12px;
            }

            .option-card {
                padding: 25px 20px;
                border-radius: 20px;
            }

            .option-icon {
                font-size: 40px;
            }

            .option-card h2 {
                font-size: 20px;
                margin-bottom: 10px;
            }

            .option-card p {
                font-size: 14px;
            }

            .editor-title {
                font-size: 24px;
            }

            .back-btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .toolbar {
                padding: 12px;
                gap: 8px;
            }

            .toolbar button,
            .toolbar select {
                padding: 7px 14px;
                font-size: 13px;
            }

            .toolbar input[type="color"] {
                width: 38px;
                height: 35px;
            }

            .diary-editor {
                padding: 20px;
                min-height: 400px;
                font-size: 15px;
            }

            .export-section input {
                padding: 14px 20px;
                font-size: 15px;
            }

            .export-btn {
                padding: 14px 30px;
                font-size: 15px;
            }

            .modal-content {
                padding: 25px;
                border-radius: 20px;
            }

            .modal-content h2 {
                font-size: 22px;
                margin-bottom: 20px;
            }

            .modal-content textarea {
                padding: 15px;
                min-height: 100px;
                font-size: 14px;
            }

            .modal-buttons {
                gap: 15px;
                margin-top: 25px;
            }

            .modal-buttons button {
                padding: 14px;
                font-size: 15px;
            }

            footer {
                padding: 25px 15px;
                margin-top: 60px;
            }

            .footer-text {
                font-size: 13px;
            }

            .footer-copyright {
                font-size: 12px;
            }

            .social-links {
                gap: 15px;
            }

            .social-link {
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="stars" id="stars"></div>

    <div class="container">
        <div id="homePage">
            <div class="logo-container">
                <div class="logo-wrapper">
                    <img src="dixo_ai_logo.jpg" alt="diXo Logo" class="logo">
                </div>
                <h1 class="brand-title">diXo</h1>
                <p class="brand-subtitle">AI-Powered Diary Writer</p>
            </div>

            <div class="home-options">
                <div class="option-card" onclick="showEditor('new')">
                    <span class="option-icon">‚ú®</span>
                    <h2>Create from Scratch</h2>
                    <p>Start a new diary journey with AI assistance to capture your thoughts beautifully</p>
                </div>
                <div class="option-card" onclick="document.getElementById('fileInput').click()">
                    <span class="option-icon">üìñ</span>
                    <h2>Open Existing Diary</h2>
                    <p>Continue writing in your existing .dixo diary file and keep your memories alive</p>
                </div>
            </div>

            <input type="file" id="fileInput" accept=".dixo" onchange="openDiary(event)">
        </div>

        <div id="editorPage" class="editor-container">
            <div class="editor-header">
                <h1 class="editor-title">‚ú® diXo Editor</h1>
                <button class="back-btn" onclick="goBack()">‚Üê Back to Home</button>
            </div>

            <div class="toolbar">
                <button onclick="document.execCommand('bold')" title="Bold"><b>B</b></button>
                <button onclick="document.execCommand('italic')" title="Italic"><i>I</i></button>
                <button onclick="document.execCommand('underline')" title="Underline"><u>U</u></button>
                <button onclick="document.execCommand('strikeThrough')" title="Strikethrough"><s>S</s></button>
                <button onclick="document.execCommand('justifyLeft')" title="Align Left">‚óß</button>
                <button onclick="document.execCommand('justifyCenter')" title="Align Center">‚ó®</button>
                <button onclick="document.execCommand('justifyRight')" title="Align Right">‚ó©</button>
                <button onclick="document.execCommand('justifyFull')" title="Justify">‚¨ö</button>
                <button onclick="document.execCommand('insertUnorderedList')" title="Bullet List">‚Ä¢ List</button>
                <button onclick="document.execCommand('insertOrderedList')" title="Numbered List">1. List</button>
                <button onclick="document.execCommand('indent')" title="Indent">‚Üí</button>
                <button onclick="document.execCommand('outdent')" title="Outdent">‚Üê</button>

                <select onchange="document.execCommand('fontSize', false, this.value); this.value='';" title="Font Size">
                    <option value="">Font Size</option>
                    <option value="1">Tiny</option>
                    <option value="2">Small</option>
                    <option value="3">Normal</option>
                    <option value="4">Medium</option>
                    <option value="5">Large</option>
                    <option value="6">Extra Large</option>
                    <option value="7">Huge</option>
                </select>

                <select onchange="document.execCommand('fontName', false, this.value); this.value='';" title="Font Family">
                    <option value="">Font Family</option>
                    <option value="Arial">Arial</option>
                    <option value="Georgia">Georgia</option>
                    <option value="Times New Roman">Times New Roman</option>
                    <option value="Courier New">Courier New</option>
                    <option value="Verdana">Verdana</option>
                    <option value="Comic Sans MS">Comic Sans</option>
                    <option value="Impact">Impact</option>
                </select>

                <input type="color" onchange="document.execCommand('foreColor', false, this.value)" title="Text Color">
                <input type="color" onchange="document.execCommand('backColor', false, this.value)" title="Background Color">

                <button class="ai-btn" onclick="showAIModal()">‚ú® AI Magic</button>
            </div>

            <div id="diaryEditor" class="diary-editor" contenteditable="true">
                <p style="color: #999; font-style: italic;">Start writing your diary here... Let your thoughts flow freely. ‚ú®</p>
            </div>

            <div class="export-section">
                <input type="text" id="fileName" placeholder="Enter diary name (e.g., My Summer Adventures 2024)">
                <button class="export-btn" onclick="exportDiary()">üíæ Export Diary</button>
            </div>
        </div>
    </div>

    <div id="aiModal" class="modal">
        <div class="modal-content">
            <h2>‚ú® AI Diary Generator</h2>
            <textarea id="aiPrompt" placeholder="Describe what you'd like to write about...&#10;&#10;Examples:&#10;‚Ä¢ Write about my first day at university&#10;‚Ä¢ Describe a peaceful morning by the lake&#10;‚Ä¢ Reflect on today's accomplishments&#10;‚Ä¢ Express my gratitude for my friends"></textarea>
            <div class="loading" id="loading">‚ú® Crafting your diary entry</div>
            <div class="modal-buttons">
                <button class="generate-btn" onclick="generateWithAI()">‚ú® Generate</button>
                <button class="cancel-btn" onclick="closeAIModal()">Cancel</button>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-text">
                <strong>Made by Aryansh Rai</strong> (@real.foil)
            </div>
            <div class="social-links">
                <a href="#" class="social-link" title="Instagram">üì∑</a>
                <a href="#" class="social-link" title="GitHub">üíª</a>
                <a href="#" class="social-link" title="Email">‚úâÔ∏è</a>
            </div>
            <div class="footer-divider">‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ</div>
            <div class="footer-copyright">
                ¬© 2024 diXo. All rights reserved. | Powered by AI | Built with precision, passion, and code ‚ú®
            </div>
        </div>
    </footer>

    <script>
        // Generate stars background
        function generateStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 100;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 3 + 's';
                star.style.opacity = Math.random() * 0.5 + 0.3;
                starsContainer.appendChild(star);
            }
        }

        generateStars();

        let currentFileName = '';

        function showEditor(mode) {
            document.getElementById('homePage').style.display = 'none';
            document.getElementById('editorPage').style.display = 'block';
            
            if (mode === 'new') {
                document.getElementById('diaryEditor').innerHTML = '<p style="color: #999; font-style: italic;">Start writing your diary here... Let your thoughts flow freely. ‚ú®</p>';
                currentFileName = '';
            }
        }

        function goBack() {
            if (confirm('‚ö†Ô∏è Are you sure you want to go back? Any unsaved changes will be lost.')) {
                document.getElementById('homePage').style.display = 'block';
                document.getElementById('editorPage').style.display = 'none';
                document.getElementById('diaryEditor').innerHTML = '<p style="color: #999; font-style: italic;">Start writing your diary here... Let your thoughts flow freely. ‚ú®</p>';
                document.getElementById('fileName').value = '';
                currentFileName = '';
            }
        }

        function showAIModal() {
            document.getElementById('aiModal').style.display = 'flex';
            document.getElementById('aiPrompt').value = '';
            document.getElementById('loading').style.display = 'none';
            document.getElementById('aiPrompt').focus();
        }

        function closeAIModal() {
            document.getElementById('aiModal').style.display = 'none';
        }

        async function generateWithAI() {
            const prompt = document.getElementById('aiPrompt').value.trim();
            
            if (!prompt) {
                alert('‚ö†Ô∏è Please enter a prompt to generate your diary entry!');
                return;
            }

            document.getElementById('loading').style.display = 'block';

            try {
                const response = await fetch("https://api.anthropic.com/v1/messages", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        model: "claude-sonnet-4-20250514",
                        max_tokens: 1000,
                        messages: [
                            { 
                                role: "user", 
                                content: `You are a professional diary writing assistant. Write a personal, emotional, and authentic diary entry based on my prompt. Write in first person, using present or past tense as appropriate. Be introspective, detailed, and capture genuine human emotions. DO NOT include meta-commentary like 'Here is your diary entry' or start with 'Dear Diary' unless I explicitly request it. Just write the raw, authentic diary content directly with natural paragraph breaks. Make it feel real and heartfelt.

My prompt: ${prompt}` 
                            }
                        ],
                    })
                });

                const data = await response.json();
                
                // Extract text from the response
                let aiText = '';
                if (data.content && Array.isArray(data.content)) {
                    aiText = data.content
                        .filter(item => item.type === 'text')
                        .map(item => item.text)
                        .join('\n\n');
                }

                if (!aiText) {
                    throw new Error('No content generated');
                }

                // Clean up the AI response
                const cleanedText = aiText
                    .replace(/^(Here is your diary entry|Here's your diary entry|Here is a diary entry|Dear Diary)[:\s]*/i, '')
                    .replace(/^[\s\n]+/, '')
                    .replace(/\*\*/g, '')
                    .trim();

                // Format with proper HTML paragraphs
                const formattedText = cleanedText
                    .split(/\n\n+/)
                    .filter(para => para.trim().length > 0)
                    .map(para => `<p style="margin-bottom: 1em;">${para.trim()}</p>`)
                    .join('');

                const editor = document.getElementById('diaryEditor');
                const currentContent = editor.innerHTML;

                // Check if editor has placeholder text
                if (currentContent.includes('Start writing your diary here') || currentContent.trim() === '') {
                    editor.innerHTML = formattedText;
                } else {
                    editor.innerHTML += '<br><br>' + formattedText;
                }

                // Scroll to bottom of editor
                editor.scrollTop = editor.scrollHeight;

                closeAIModal();
                
                // Show success message
                const notification = document.createElement('div');
                notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #00d9ff, #7000ff); color: white; padding: 15px 25px; border-radius: 10px; z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.3); animation: slideIn 0.3s ease;';
                notification.textContent = '‚ú® Diary entry generated successfully!';
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);

            } catch (error) {
                alert('‚ùå Failed to generate AI content. Please try again.');
                console.error('AI Generation Error:', error);
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }

        function exportDiary() {
            const fileName = document.getElementById('fileName').value.trim();
            
            if (!fileName) {
                alert('‚ö†Ô∏è Please enter a file name before exporting!');
                document.getElementById('fileName').focus();
                return;
            }

            const diaryContent = document.getElementById('diaryEditor').innerHTML;

            // Check if content is just the placeholder
            if (diaryContent.includes('Start writing your diary here') || diaryContent.trim() === '') {
                alert('‚ö†Ô∏è Your diary is empty! Please write something before exporting.');
                return;
            }

            const dixoFormat = `=================DIXO.FOILAI.IN==========================
=================AI DIARY MAKER!=========================
?diarycontent="
${diaryContent}
"?end-diarycontent=true
================MADE BY ARYANSH RAI (ig/@real.foil)========================
?signature=${btoa(fileName + Date.now())}
?encrypted=true
?version=2.0`;

            const blob = new Blob([dixoFormat], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName + '.dixo';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);

            // Show success message
            const notification = document.createElement('div');
            notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #00d9ff, #7000ff); color: white; padding: 15px 25px; border-radius: 10px; z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.3); animation: slideIn 0.3s ease;';
            notification.textContent = 'üíæ Diary exported successfully as ' + fileName + '.dixo';
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        function openDiary(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (!file.name.endsWith('.dixo')) {
                alert('‚ùå Invalid file format! Please select a .dixo file.');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;

                // Validate dixo file format
                if (!content.includes('=================DIXO.FOILAI.IN==========================')) {
                    alert('‚ùå Invalid .dixo file format! This file may be corrupted.');
                    return;
                }

                // Extract diary content
                const match = content.match(/\?diarycontent="([\s\S]*?)"\?end-diarycontent=true/);
                if (match && match[1]) {
                    const diaryContent = match[1].trim();
                    document.getElementById('diaryEditor').innerHTML = diaryContent;

                    // Set filename without extension
                    currentFileName = file.name.replace('.dixo', '');
                    document.getElementById('fileName').value = currentFileName;

                    showEditor('existing');

                    // Show success message
                    const notification = document.createElement('div');
                    notification.style.cssText = 'position: fixed; top: 20px; right: 20px; background: linear-gradient(135deg, #00d9ff, #7000ff); color: white; padding: 15px 25px; border-radius: 10px; z-index: 10000; box-shadow: 0 10px 30px rgba(0,0,0,0.3);';
                    notification.textContent = '‚úÖ Diary loaded successfully!';
                    document.body.appendChild(notification);
                    
                    setTimeout(() => notification.remove(), 3000);
                } else {
                    alert('‚ùå Could not read diary content! The file may be corrupted.');
                }
            };
            
            reader.onerror = function() {
                alert('‚ùå Error reading file! Please try again.');
            };
            
            reader.readAsText(file);
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + S to export
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                if (document.getElementById('editorPage').style.display === 'block') {
                    exportDiary();
                }
            }
            
            // Ctrl/Cmd + K to open AI modal
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                if (document.getElementById('editorPage').style.display === 'block') {
                    showAIModal();
                }
            }
            
            // Escape to close modal
            if (e.key === 'Escape') {
                closeAIModal();
            }
        });

        // AI prompt keyboard shortcut (Ctrl/Cmd + Enter to generate)
        document.getElementById('aiPrompt').addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                generateWithAI();
            }
        });

        // Click outside modal to close
        document.getElementById('aiModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAIModal();
            }
        });

        // Auto-save notification (visual feedback)
        let autoSaveTimer;
        document.getElementById('diaryEditor').addEventListener('input', function() {
            clearTimeout(autoSaveTimer);
            autoSaveTimer = setTimeout(() => {
                // Visual feedback that content is ready
                const editor = document.getElementById('diaryEditor');
                editor.style.borderColor = 'rgba(0, 217, 255, 0.5)';
                setTimeout(() => {
                    editor.style.borderColor = '';
                }, 500);
            }, 1000);
        });

        // Add CSS for notifications
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(400px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(400px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Remove placeholder text on first click
        document.getElementById('diaryEditor').addEventListener('click', function() {
            if (this.innerHTML.includes('Start writing your diary here')) {
                this.innerHTML = '';
            }
        });
    </script>
</body>
</html>
